### 1. RDBMS, NoSQL에서의 클러스터링/레플리케이션 방식에 대해 설명해 주세요.<br>
Clustering: 여러개의 DB를 수평적인 구조로 구축하는 방식, 동기로 데이터 무결성을 유지한다. <br>
Replication: Master(Write담당)-Slave(Read 담당) 구조 같이 여러개의 DB를 권한에 따라 수직적으로 구축하는 방식, 비동기로 데이터 무결성 검사를 하지 않는다. <br>

NoSQL의 경우 대부분 여러개의 데이터베이스 서버를 묶어 하나의 크러스터를 구성해 사용한다. 

### Q2. 이러한 분산 환경에선, 트랜잭션을 어떻게 관리할 수 있을까요?
네트워크 지연 및 연결 오류로 인한 트랜잭션 실패, 데드락, 데이터 일관성 등의 이유로 분산환경에서의 트랜잭션 관리가 필요하다. 

2-Phase-Commit(2PC) 또는 SAGA 패턴을 통해 관리할 수 있다.
- 2-Phase-Commit 방식
Coordinator가 db간에 트랜잭션을 조율한다. Prepare-Commit phase 두 단계가 있으며, prepare 단계에서 transaction과 관련한 모든 서비스에게 쿼리를 보내고 응답을 확인한다. 그후 commit 단계에서 해당 요청을 환인하고 commit할지 rollback할지 판단 후 실행한다.

- SAGA 패턴
각 DB 서비스의 트랜잭션을 우선적으로 순차적 처리합니다. 그 후 트랜잭션 상태를 체크하여 처리되지 않은 트랜잭션이 있다면 전체를 롤백합니다.

### Q3. 마스터, 슬레이브 데이터 동기화 전 까지의 데이터 정합성을 지키는 방법은 무엇이 있을까요?
마스터가 트랜잭션 로그를 슬레이브에 전송하고, 슬레이브는 이 로그에 따라 순차적으로 데이터를 업데이트하는 방식을 고려해볼 수 있다. 
마스터가 데이터 변경사항을 전체 슬레이브가 아닌 하나 이상의 슬레이브에만 복제하면 작업을 완료한 것으로 간주하여 부하를 줄일 수도 있다.

### Q4. 다중 트랜잭션 상황에서의 Deadlock 상황과, 이를 해결하기 위한 방법에 대해 설명해 주세요.
Dead Lock이란 트랜잭션에서 필요한 자원에 접근하지 못해 계속 자원을 기다리는 교착 상태를 지칭하는 말이다. 아래의 4가지가 동시에 성립할 때 발생한다.
1) 상호 배제: 자원은 한번에 한 프로세스만 쓸 수 있다.
2) 점유 대기: 최소 하나의 자원에 접근하고 있으며 다른 트랜잭션이 접근한 자원을 대기하고 있는 트랜잭션이 존재한다.
3) 비선점: 이미 다른 곳에서 접근하고 있는 자원은 사용이 끝날 때까지 빼앗을 수 없다.
4) 순환 대기: 트랜잭션(1...n)이 존재할 때 각각이 접근하고 있는 자원을 k + 1 트랜잭션이 요구하고 있어야 한다.

4가지 조건 중 하나만 불성립해도 deadlock을 방지할 수 있다. 따라서
1) 트랜잭션이 공유 자원을 사용할 수 있도록 하거나
2) 한 트랜잭션이 필요한 자원을 모두 한번에 몰아준다거나 (그럼 다른 트랜잭션이 못 접근함)
3) 다른 트랜잭션이 지금 접근중인 자원을 요구한다면 자원을 넘겨주고 기다리게 하거나
4) 우선순위에 맞게 자원을 접근할 수 있게 한다.

그러나 Deadlock을 방지하는 것은 굉장히 비용이 많이 드는 일이다. 따라서
1) 타임아웃 설정
2) 데드락 발생을 감지하고 그 후 트랜잭션을 롤백하는 방식을 사용할 수 있다.

### Q5. 샤딩 방식은 무엇인가요? 만약 본인이 DB를 분산해서 관리해야 한다면, 레플리케이션 방식과 샤딩 방식 중 어떤 것을 사용할 것 같나요?
Sharding이란 테이블을 쪼개어 데이터를 분산 저장하는 방식이다.  <br>
레플리케이션 방식은 결국 한 데이터베이스 서버가 메인이 되므로, 서비스를 제공하기 위한 리소스가 부족하다고 여겨지면 샤딩을 통해 운영하는 것이 필요하다. 데이터를 빠르게 읽기 위해서는 레플리케이션 방식을 선택할 것이다. 
### References
https://mangkyu.tistory.com/97
https://velog.io/@ch200203/MSA-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C%EC%9D%98-%EB%B6%84%EC%82%B0-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B4%80%EB%A6%AC2PC-SAGA-%ED%8C%A8%ED%84%B4